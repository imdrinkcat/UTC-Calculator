<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<title>UTC累计秒计算器（修正时区解释）</title>
<style>
  body { font-family: Arial, sans-serif; background:#f4f4f9; color:#333; padding:20px; text-align:center;}
  h1 { color:#4CAF50; }
  label { display:block; margin:14px 0 6px; }
  input[type="text"] { width: calc(100% - 40px); max-width:500px; padding:10px; font-size:16px; border:1px solid #ccc; border-radius:6px; box-sizing:border-box; margin:6px auto;}
  .radios { display:flex; justify-content:center; gap:16px; margin-top:8px; }
  button { background:#4CAF50; color:white; border:none; padding:10px 18px; font-size:16px; border-radius:6px; cursor:pointer; margin-top:16px;}
  button:hover{ background:#45a049;}
  #result{ margin-top:18px; font-size:18px; }
  .note{ font-size:13px; color:#666; margin-top:8px; }
</style>
</head>
<body>
  <h1>UTC累计秒计算器（修正时区解释）</h1>

  <label>UTC起点时间（格式：YYYY-MM-DD HH:mm:ss）：</label>
  <input type="text" id="start-dt" value="2009-01-01 00:00:00">

  <div class="radios">
    <label><input type="radio" name="startTz" value="UTC" checked> 起点为 UTC</label>
    <label><input type="radio" name="startTz" value="CST"> 起点为 北京时间 (UTC+8)</label>
  </div>

  <label style="margin-top:14px;">输入时间（格式：YYYY-MM-DD HH:mm:ss，默认为北京时间 UTC+8）：</label>
  <input type="text" id="input-dt" value="2009-01-01 00:00:00">

  <button onclick="calculate()">计算UTC累计秒</button>

  <div id="result"></div>
  <div class="note">
    说明：<br>
    • 当“起点为 UTC”且“输入时间为北京时间（UTC+8）”时，两个相同的字符串会相差 -28800 秒（因为北京时间比 UTC 晚 8 小时）。<br>
    • 若你想让“相同字符串 = 0 秒”，请选择“起点为 北京时间 (UTC+8)”。
  </div>

<script>
  // 手工解析 YYYY-MM-DD HH:mm:ss，返回 {ok:bool, utcMs:number}
  function parseYYYYMMDD_hhmmss_as_utcMillis(s) {
    // 允许额外空白
    const str = (s || '').trim();
    const m = str.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?$/);
    if (!m) return { ok: false, msg: '格式应为 YYYY-MM-DD HH:mm:ss' };
    const y = Number(m[1]), mo = Number(m[2]) - 1, d = Number(m[3]);
    const hh = Number(m[4]), mm = Number(m[5]), ss = Number(m[6] || '0');
    // 使用 Date.UTC 生成对应的 UTC 毫秒数
    const ms = Date.UTC(y, mo, d, hh, mm, ss);
    if (isNaN(ms)) return { ok: false, msg: '无法解析日期' };
    return { ok: true, utcMs: ms };
  }

  function calculate() {
    const startStr = document.getElementById('start-dt').value;
    const inputStr = document.getElementById('input-dt').value;
    const startTz = document.querySelector('input[name="startTz"]:checked').value; // "UTC" or "CST"

    // 解析起点字符串（用户输入）
    const parsedStart = parseYYYYMMDD_hhmmss_as_utcMillis(startStr);
    if (!parsedStart.ok) { document.getElementById('result').innerText = '起点解析错误：' + parsedStart.msg; return; }

    // 解析输入字符串（页面约定：用户输入的是北京时间）
    const parsedInput = parseYYYYMMDD_hhmmss_as_utcMillis(inputStr);
    if (!parsedInput.ok) { document.getElementById('result').innerText = '输入时间解析错误：' + parsedInput.msg; return; }

    // 解析后的 utcMs 是“把该字符串当作对应时刻的 UTC 时间得到的毫秒数”。
    // 因为我们有两种语义，分别调整：
    // - 若起点标为 UTC： parsedStart.utcMs 已是正确的 UTC 毫秒
    // - 若起点标为 北京时间： 起点实际对应 UTC，应减去 8 小时
    let startUtcMs = parsedStart.utcMs;
    if (startTz === 'CST') {
      startUtcMs = parsedStart.utcMs - (8 * 3600 * 1000);
    }

    // 页面约定：输入时间是“北京时间(UTC+8)”，因此将其转换为 UTC：减去 8 小时
    const inputUtcMs = parsedInput.utcMs - (8 * 3600 * 1000);

    const diffSec = Math.floor((inputUtcMs - startUtcMs) / 1000);

    // 为便于理解，同时显示两端对应的 UTC 时间
    const startUtcIso = new Date(startUtcMs).toISOString().replace('T', ' ').replace('Z',' UTC');
    const inputUtcIso = new Date(inputUtcMs).toISOString().replace('T', ' ').replace('Z',' UTC');

    document.getElementById('result').innerHTML =
      `<strong>UTC累计秒：</strong> ${diffSec} 秒<br>
       <small>（起点对应 UTC：${startUtcIso}，输入对应 UTC：${inputUtcIso}）</small>`;
  }
</script>
</body>
</html>
